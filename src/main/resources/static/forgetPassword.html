<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Forgot Password</title>
    <style>
        body { font-family: Arial; margin: 30px; }
        .form { margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; }
        input { padding: 8px; width: 250px; }
        button { margin-top: 10px; padding: 8px 16px; }
        #message { margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>
<h2>Forgot Password</h2>

<div id="step1">
    <h3>Step 1: Enter your email</h3>
    <input type="email" id="email" placeholder="Enter your email" required>
    <button onclick="sendOtp()">Send OTP</button>
</div>

<div id="step2" style="display:none;">
    <h3>Step 2: Verify OTP</h3>
    <input type="text" id="otp" placeholder="Enter OTP" required>
    <button onclick="verifyOtp()">Verify OTP</button>
</div>

<div id="step3" style="display:none;">
    <h3>Step 3: Reset Password</h3>
    <input type="password" id="newPassword" placeholder="New Password" required>
    <button onclick="resetPassword()">Reset Password</button>
</div>

<p id="message"></p>

<script>
    async function sendOtp() {
        const email = document.getElementById("email").value;
        const res = await fetch("http://localhost:8080/auth/forgot-password?email=" + email, { method: "POST" });
        document.getElementById("message").innerText = await res.text();
        if (res.ok) document.getElementById("step2").style.display = "block";
    }

    async function verifyOtp() {
        const email = document.getElementById("email").value;
        const otp = document.getElementById("otp").value;
        const res = await fetch(`http://localhost:8080/auth/verify-otp?email=${email}&otp=${otp}`, { method: "POST" });
        document.getElementById("message").innerText = await res.text();
        if (res.ok) document.getElementById("step3").style.display = "block";
    }

    async function resetPassword() {
        const email = document.getElementById("email").value;
        const otp = document.getElementById("otp").value;
        const newPassword = document.getElementById("newPassword").value;
        const res = await fetch(`http://localhost:8080/auth/reset-password?email=${email}&otp=${otp}&newPassword=${newPassword}`, { method: "POST" });
        document.getElementById("message").innerText = await res.text();
    }
</script>
</body>
</html>